<!DOCTYPE html>
<html>

<head>

	<title>Poker University</title>
	<link rel="stylesheet" type="text/css" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
		<script src="/socket.io/socket.io.js"></script>
    <script>
        $(document).ready(function(){
            //Only shows active tab.
            $(".mode-window:not(:first)").hide();
            $(".tab-head").click(function(){
                $(".mode-window").hide();
                $("." + $(this).attr('name')).show();
            });
        });
				var socket = io();
				socket.on('connect', function() {
					$(function() {
						let name = "guest";
						$.ajax({
							async: false,
							type: 'GET',
							//url: 'http://pokeruniversity.herokuapp.com/update_username',
							url: 'http://localhost/update_username',
							success: function(data) {
								name = data;
								console.log(name);
							}
						})
						socket.emit('joinMain', name);
				})
			})

			socket.on	('updatechat', function (username, data) {
				$('#adminChatBox').append(username + ':</b> ' + data + '<br>');
				let obj = document.getElementById("adminChatBox");
				obj.scrollTop = obj.scrollHeight;
			});

			$(function(){
				// when the client clicks SEND
				$('#send').click( function() {
					var message = $('#text').val();
					$('#text').val('');
					// tell server to execute 'sendchat' and send along one parameter
					socket.emit('sendchat', message);
				});
				// when the client hits ENTER on their keyboard
				$('#text').keypress(function(e) {
					if(e.which == 13) {
						$(this).blur();
						$('#send').focus().click();
					}
				});
			});

    </script>
</head>


<body>
    <div class="main-header">
        <h1 id="mainTitle" class="page-title">Poker University</h1>
			<form id="logoutButton" action="logout_get" method="POST">
        <input type="submit" id="logout" name="logout" value="logout">
			</form>
    </div>
    <div class="main-body">

        <div class="sub-container" id="playModes">
            <div class="tab-select sub-box" id="mainHeads">
                <div class="tab-head" name="pvp-option" id="pvp">
                    <h3>Player vs Players</h3>
                </div>
                <div class="tab-head" name="pvb-option" id="pvb">
                    <h3>Player vs Bots</h3>
                </div>
                <div class="tab-head" name="tutorial-window-option" id="tutorial">
                    <h3>Tutorial</h3>
                </div>
                <div class="tab-head" name="host-lobby-option" id="hostLobby">
                    <h3>Host Lobby</h3>
                </div>
            </div>
            <div class="sub-box" id="modeWindows">
                <div class="mode-window pvp-option" id="pvpWindow">
									<form id="joinForm" action="join_game" method="POST">
                    <input type="submit" class="play-button" id="joinButton" value="Join">
									</form>
                </div>
                <div class="mode-window pvb-option" id="pvbWindow">
									<form id="botForm" action="join_bot_game" method="POST">
                    <input type="submit" class="play-button" id="botsButton" value="Play">
									</form>
                </div>
                <div class="mode-window tutorial-window-option" id="tutorialWindow">
									<form id="tutorialForm" action="join_tutorial" method="POST">
                    <input type="submit" class="play-button" id="tutorialButton" value="Play">
									</form>
                </div>
                <div class="mode-window host-lobby-option" id="hostLobbyWindow">
                    <form id="hostForm" action="host_game" method="POST">
                        <p class="field-title">Room Name</p>
                        <input type="text" id="roomName" name="roomName" required='required' pattern="[A-Za-z0-9]{1,20}" oninvalid="this.setCustomValidity('Please enter a valid username')" oninput="this.setCustomValidity('')">
                        <p class="field-title">Max players (2-8)</p>
                        <input type="number" name="numPlayers" required='required'>
                        <p class="field-title">Password (Leave blank if public)</p>
                        <input type="text" name="roomPass">
                        <p class="field-title">Number of AI</p>
                        <input type="number" name="numAI" required='required'></br>
												<input type="radio" name="difficulty" value="1">Simple</br>
												<input type="radio" name="difficulty" value="2">Easy</br>
												<input type="radio" name="difficulty" value="3">Medium</br>
												<input type="radio" name="difficulty" value="4">Hard</br>
                        <p class="field-title">Enable Antes</p>
                        <input type="checkbox" name="anteOption">
                        <p class="field-title">Starting Chips</p>
                        <input type="number" name="startChips" required='true'>
                        <input type="submit" class="play-button" value="Create">
                    </form>
                </div>
            </div>
            <div id="serverInfo">
                <p>Players online: </p>
                <p>Friends online: </p>
                <p>Active tables: </p>
            </div>
						<form id="profile" action="profile_page" method="POST">
							<input type="submit" id="profileButton" name="profileButton" value="Profile">
						</form>
        </div>
        <div class="sub-container" id="playerInfo">
            <div class="sub-box" id="profile">
                <div id="chips">
                    <h3 id="chipTitle">Chips:</h2>
                        <h3 id="chipCount"></h3>
                </div>
                <img src="" id="profilePic" />
            </div>
            <div class="sub-box" id="playerStats">
            </div>
            <div class="sub-box" id="friendsList">
            </div>
        </div>
				<div class="mainChatContainer" id="chatBox">
					<div id="adminChatBox" style="overflow-y:scroll">
					</div>
					<div id="adminChatInputField">
							<input type="text" id="text" name="chatMessage">
							<input type="submit" id="send" name="chatSubmit" value="Send">
					</div>
				</div>
    </div>
</body>

</html>
