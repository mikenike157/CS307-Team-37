<!DOCTYPE html>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>

window.onload = function() {
	$.ajax({
		async: false,
		type: 'GET',
		//url: 'http://pokeruniversity.herokuapp.com/getRooms',
		url: '/getRooms',
		success: function(data) {
				if (data == "") {
					document.getElementById("roomForm").innerHTML = "There are no open rooms";
				}
				else {
					document.getElementById("roomForm").innerHTML = data;
				}
		}
	})
}

var socket = io();

function validatePassword() {
	var x = $('input[name=radio]:checked').val()
	console.log(x);
	socket.emit('checkRoomPass', x);
}

socket.on('connect', function() {
	$(function() {
		let name = "guest";
		$.ajax({
			async: false,
			type: 'GET',
			//url: 'http://pokeruniversity.herokuapp.com/update_username',
			url: '/update_username',
			success: function(data) {
				name = data;
				console.log(name);
			}
		})
		socket.emit('gameSelection', name);
	})
})

socket.on('joinGame', function() {
	var x = $('input[name=radio]:checked').val()
	$.ajax({
		async: false,
		type: 'POST',
		url: '/room_post',
		data: {
			roomName: x
		},
		success: function(data) {
			window.location.replace('/game.html');
		}
	})
})

socket.on('givePass', function(password) {
	console.log(password);
	var x = $('input[name=radio]:checked').val()
	var pass = prompt("Password", "");
	console.log(pass);
	if (pass == "" || pass == null) {
			return;
	}
	else if (pass != password) {
		socket.emit('checkRoomPass', x);
		return;
	}
	/*else if (pass == "") {
		return;
	}*/
	else {
		$.ajax({
			async: false,
			type: 'POST',
			data: {
				roomName: x
			},
			url: '/room_post',
			success: function(data) {
				window.location.replace('/game.html')
			}
		})
		return;
	}
})

</script>



<html>
<head>
	<title>Host Game</title>
</head>
<body>
	<form id="roomForm" name="roomForm">
  </form>
</body>
</html>
