<!DOCTYPE html>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>

<script>
  $(function() {
    $('#leader_chips').click( function() {
      $.ajax({
        async: false,
        type: 'GET',
        url: '/get_leaderboard_chips',
        success: function(data) {
          document.getElementById('board').innerHTML = "";
          for (let i = 0; i < data.length; i++) {
            document.getElementById('board').innerHTML += (data[i] + "</br>")
          }
        }
      })
    })
  })
  $(function() {
    $('#leader_wins').click( function() {
      $.ajax({
        async: false,
        type: 'GET',
        url: '/get_leaderboard_wins',
        success: function(data) {
          document.getElementById('board').innerHTML = "";
          for (let i = 0; i < data.length; i++) {
            document.getElementById('board').innerHTML += (data[i] + "</br>")
          }
        }
      })
    })
  })
  function uploadAvatar(file) {
    const reader = new FileReader();
    const xhr = new XMLHttpRequest();
    xhr.open("POST", "/change_avatar");
    xhr.overrideMimeType(file.type);
    xhr.setRequestHeader('Content-Type', file.type);
    console.log(file.type);
    reader.onload = function(e) {
      console.log(e.target.result);
      xhr.send(e.target.result);
    };
    reader.readAsArrayBuffer(file);
    console.log(xhr);
  }
</script>




<html>
<head>
	<title>Profile</title>
</head>
<body>
  <h1> {USER}'s Profile</h1>
  <div class="user_avatar">
    <img src="/avatar/{ID}" width="128" height="128" />
    <br />
    <input type="file"
       id="avatar" name="avatar"
       accept="image/*"
       value="Change"
       onchange="uploadAvatar(this.files[0]);" />
  </div>
  <div class="user_profile">
    <p class="field-title">Total Chips: {CHIPS}</br></p>
    <p class="field-title">Total Wins: {WINS}</br></p>
    <a id="passwordRecoveryLink" href="/recover.html">Change Password</br></a>
    <a id="changeUsernameLink" href="/username.html">Change Username</br></a>
    <p id='board'>
    </p>
    <input type="button" id="leader_chips" name="leader" value="Leaderboard Chips">
    <input type="button" id="leader_wins" name="leader" value="Leaderboard Wins">
  </div>
</body>
</html>
